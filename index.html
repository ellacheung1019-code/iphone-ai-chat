<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>iPhone AI Chat</title>

<style>
body{
margin:0;
background:#000;
font-family:-apple-system,BlinkMacSystemFont;
color:#fff;
}

.app{
display:flex;
flex-direction:column;
height:100vh;
background:#000;
}

.header{
text-align:center;
padding:15px;
font-weight:600;
border-bottom:1px solid #222;
background:#000;
}

.settings{
padding:10px;
background:#111;
font-size:13px;
}

.settings input,.settings select{
width:100%;
padding:8px;
margin:5px 0;
border-radius:10px;
border:none;
background:#222;
color:#fff;
}

.settings button{
width:100%;
padding:8px;
border:none;
border-radius:10px;
background:#0a84ff;
color:#fff;
margin-top:5px;
}

.chat{
flex:1;
overflow-y:auto;
padding:15px;
background:#000;
}

.bubble{
max-width:75%;
padding:12px 16px;
border-radius:22px;
margin:8px 0;
font-size:15px;
line-height:1.4;
word-wrap:break-word;
}

.user{
background:#0a84ff;
margin-left:auto;
border-bottom-right-radius:6px;
}

.bot{
background:#2c2c2e;
border-bottom-left-radius:6px;
}

.input-area{
display:flex;
padding:10px;
background:#111;
border-top:1px solid #222;
}

.input-area input{
flex:1;
padding:12px;
border-radius:20px;
border:none;
background:#222;
color:#fff;
}

.input-area button{
margin-left:8px;
padding:12px 16px;
border:none;
border-radius:20px;
background:#0a84ff;
color:#fff;
}
</style>
</head>

<body>
<div class="app">

<div class="header">ğŸ AI èŠå¤©</div>

<div class="settings">
<div>API åŸºç¤åœ°å€</div>
<input id="baseUrl" placeholder="https://api.openai.com">
<div>API Key</div>
<input id="apiKey" type="password">
<div>æ¨¡å‹é¸æ“‡</div>
<select id="modelSelect"></select>
<button onclick="loadModels()">æ‹‰å–æ¨¡å‹</button>
</div>

<div class="chat" id="chat"></div>

<div class="input-area">
<input id="userInput" placeholder="ç™¼é€è¨Šæ¯...">
<button onclick="sendMessage()">ç™¼é€</button>
</div>

</div>

<script>
let conversation=[];

window.onload=function(){
document.getElementById("baseUrl").value=localStorage.getItem("baseUrl")||"";
document.getElementById("apiKey").value=localStorage.getItem("apiKey")||"";
};

function saveSettings(){
localStorage.setItem("baseUrl",document.getElementById("baseUrl").value);
localStorage.setItem("apiKey",document.getElementById("apiKey").value);
}

async function loadModels(){
saveSettings();
const baseUrl=document.getElementById("baseUrl").value.trim();
const apiKey=document.getElementById("apiKey").value.trim();
if(!baseUrl||!apiKey){alert("è«‹å¡«å¯«API");return;}

const res=await fetch(baseUrl+"/v1/models",{
headers:{Authorization:"Bearer "+apiKey}
});
const data=await res.json();
const select=document.getElementById("modelSelect");
select.innerHTML="";
data.data.forEach(m=>{
const op=document.createElement("option");
op.value=m.id;
op.text=m.id;
select.appendChild(op);
});
alert("æ¨¡å‹è¼‰å…¥æˆåŠŸ");
}

function addBubble(text,type){
const chat=document.getElementById("chat");
const div=document.createElement("div");
div.className="bubble "+type;
div.innerText=text;
chat.appendChild(div);
chat.scrollTop=chat.scrollHeight;
}

async function sendMessage(){
const input=document.getElementById("userInput");
const message=input.value.trim();
if(!message)return;

const baseUrl=document.getElementById("baseUrl").value.trim();
const apiKey=document.getElementById("apiKey").value.trim();
const model=document.getElementById("modelSelect").value;
if(!baseUrl||!apiKey||!model){alert("è«‹å…ˆé…ç½®API");return;}

conversation.push({role:"user",content:message});
addBubble(message,"user");
input.value="";

const res=await fetch(baseUrl+"/v1/chat/completions",{
method:"POST",
headers:{
"Content-Type":"application/json",
"Authorization":"Bearer "+apiKey
},
body:JSON.stringify({
model:model,
messages:conversation
})
});
const data=await res.json();
const reply=data.choices[0].message.content;
conversation.push({role:"assistant",content:reply});
addBubble(reply,"bot");
}
</script>

</body>
</html>
